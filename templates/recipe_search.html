{% extends "base.html" %}

{% block title %}Search Recipe{% endblock %}

{% block content %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Search</title>
    <link rel="stylesheet" href="static/css/style.css">
    <script defer src="{{ url_for('static', filename='script.js') }}"></script>
</head>

<body class="light-theme">

    <main class="container">
        <h1>Search for Recipes</h1>
        <form method="POST">
            <input type="text" name="query" placeholder="Enter ingredients seperated by," value="{{ query }}" required>
            <div>
                <select name="diet_filter">
                    <option value="">All Diets</option>
                    <option value="vegan">Vegan</option>
                    <option value="vegetarian">Vegetarian</option>
                    <option value="gluten-free">Gluten-Free</option>
                </select>
            </div>
            <button type="submit">Search</button>
        </form>
        
        <button class="toggle" id="toggle-view">
            <img id="view-icon" src="{{ url_for('static', filename='icons/grid.png') }}">
        </button>

        {% if search_results %}
        <h2>Search Results:</h2>
        <div id="recipe-container" class="grid-view">
            {% for recipe in search_results %}
            <div class="recipe-card">
                <h3>{{ recipe.name }}</h3>
                <p><strong>Diet:</strong> {{ recipe.diet_type }}</p>
                <p><strong>Ingredients:</strong> {{ recipe.ingredients }}</p>
                <a href="{{ recipe.recipe_link }}" target="_blank" class="btn">View Recipe</a>
                {% if recipe.video_link %}
                <div class="video-preview">
                    <iframe width="100%" height="200" src="{{ recipe.video_link }}" frameborder="0"
                        allowfullscreen></iframe>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% elif query %}
        <p>No recipes found for "{{ query }}". Try another search.</p>
        {% endif %}
    </main>
</body>

</html>
{% endblock %}